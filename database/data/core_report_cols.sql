BEGIN
    DBMS_OUTPUT.PUT_LINE('--');
    DBMS_OUTPUT.PUT_LINE('-- MERGE ' || UPPER('core_report_cols'));
    DBMS_OUTPUT.PUT_LINE('--');
END;
/
--
--DELETE FROM core_report_cols;
--
MERGE INTO core_report_cols t
USING (
    SELECT 'CORE_APP_HISTORY_V' AS VIEW_NAME, 'T1' AS COLUMN_NAME, '{Mon fmDD, -1}' AS REPORT_NAME FROM DUAL UNION ALL
    SELECT 'CORE_APP_HISTORY_V' AS VIEW_NAME, 'T10' AS COLUMN_NAME, '{Mon fmDD, -10}' AS REPORT_NAME FROM DUAL UNION ALL
    SELECT 'CORE_APP_HISTORY_V' AS VIEW_NAME, 'T11' AS COLUMN_NAME, '{Mon fmDD, -11}' AS REPORT_NAME FROM DUAL UNION ALL
    SELECT 'CORE_APP_HISTORY_V' AS VIEW_NAME, 'T12' AS COLUMN_NAME, '{Mon fmDD, -12}' AS REPORT_NAME FROM DUAL UNION ALL
    SELECT 'CORE_APP_HISTORY_V' AS VIEW_NAME, 'T13' AS COLUMN_NAME, '{Mon fmDD, -13}' AS REPORT_NAME FROM DUAL UNION ALL
    SELECT 'CORE_APP_HISTORY_V' AS VIEW_NAME, 'T14' AS COLUMN_NAME, '{Mon fmDD, -14}' AS REPORT_NAME FROM DUAL UNION ALL
    SELECT 'CORE_APP_HISTORY_V' AS VIEW_NAME, 'T2' AS COLUMN_NAME, '{Mon fmDD, -2}' AS REPORT_NAME FROM DUAL UNION ALL
    SELECT 'CORE_APP_HISTORY_V' AS VIEW_NAME, 'T3' AS COLUMN_NAME, '{Mon fmDD, -3}' AS REPORT_NAME FROM DUAL UNION ALL
    SELECT 'CORE_APP_HISTORY_V' AS VIEW_NAME, 'T4' AS COLUMN_NAME, '{Mon fmDD, -4}' AS REPORT_NAME FROM DUAL UNION ALL
    SELECT 'CORE_APP_HISTORY_V' AS VIEW_NAME, 'T5' AS COLUMN_NAME, '{Mon fmDD, -5}' AS REPORT_NAME FROM DUAL UNION ALL
    SELECT 'CORE_APP_HISTORY_V' AS VIEW_NAME, 'T6' AS COLUMN_NAME, '{Mon fmDD, -6}' AS REPORT_NAME FROM DUAL UNION ALL
    SELECT 'CORE_APP_HISTORY_V' AS VIEW_NAME, 'T7' AS COLUMN_NAME, '{Mon fmDD, -7}' AS REPORT_NAME FROM DUAL UNION ALL
    SELECT 'CORE_APP_HISTORY_V' AS VIEW_NAME, 'T8' AS COLUMN_NAME, '{Mon fmDD, -8}' AS REPORT_NAME FROM DUAL UNION ALL
    SELECT 'CORE_APP_HISTORY_V' AS VIEW_NAME, 'T9' AS COLUMN_NAME, '{Mon fmDD, -9}' AS REPORT_NAME FROM DUAL UNION ALL
    SELECT 'CORE_APP_HISTORY_V' AS VIEW_NAME, 'TODAY' AS COLUMN_NAME, '{Mon fmDD, -0}' AS REPORT_NAME FROM DUAL UNION ALL
    SELECT 'CORE_DAILY_VERSIONS_V' AS VIEW_NAME, 'APEX_PATCHED' AS COLUMN_NAME, 'APEX Patched' AS REPORT_NAME FROM DUAL UNION ALL
    SELECT 'CORE_DAILY_VERSIONS_V' AS VIEW_NAME, 'APEX_VERSION' AS COLUMN_NAME, 'APEX Version' AS REPORT_NAME FROM DUAL UNION ALL
    SELECT 'CORE_DAILY_VERSIONS_V' AS VIEW_NAME, 'DB_VERSION' AS COLUMN_NAME, 'DB Version' AS REPORT_NAME FROM DUAL UNION ALL
    SELECT 'CORE_DAILY_VERSIONS_V' AS VIEW_NAME, 'ORDS_VERSION' AS COLUMN_NAME, 'ORDS Version' AS REPORT_NAME FROM DUAL
) s
ON (
    t.view_name = s.view_name
    AND t.column_name = s.column_name
)
WHEN MATCHED THEN
    UPDATE SET
        t.report_name = s.report_name
WHEN NOT MATCHED THEN
    INSERT (
        t.view_name,
        t.column_name,
        t.report_name
    )
    VALUES (
        s.view_name,
        s.column_name,
        s.report_name
    );
--
COMMIT;
